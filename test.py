import matplotlib
#matplotlib.use('Agg')
import matplotlib.pyplot as plt
import numpy as np
from datetime import datetime, timedelta
import GraphFunctions as Gf
import ExtractData as Ed
import Report as Rp


#print(Ed.return_stock_info("MSFT"))

#quote = {'symbol': 'MSFT', 'name': 'Microsoft Corporation', 'price': 231.6, 'changesPercentage': 2.15, 'change': 4.87, 'dayLow': 226.49, 'dayHigh': 233.27, 'yearHigh': 246.13, 'yearLow': 132.52, 'marketCap': 1746778193920.0, 'priceAvg50': 235.04152, 'priceAvg200': 219.20825, 'volume': 41872455, 'avgVolume': 29267180, 'exchange': 'NASDAQ', 'open': 229.5165, 'previousClose': 226.73, 'eps': 6.707, 'pe': 34.53109, 'earningsAnnouncement': '2021-01-26T16:08:05.000+0000', 'sharesOutstanding': 7542220181, 'timestamp': 1615028122}
profile = {'symbol': 'MSFT', 'price': 231.6, 'beta': 0.85519, 'volAvg': 29473326, 'mktCap': 1746778190000, 'lastDiv': 2.14, 'range': '132.52-246.13', 'changes': 4.87, 'companyName': 'Microsoft Corp', 'currency': 'USD', 'cik': '0000789019', 'isin': 'US5949181045', 'cusip': '594918104', 'exchange': 'Nasdaq Global Select', 'exchangeShortName': 'NASDAQ', 'industry': 'Software Infrastructure', 'website': 'https://www.microsoft.com/en-us', 'description': 'Microsoft Corporation develops, licenses, and supports software, services, devices, and solutions worldwide. Its Productivity and Business Processes segment offers Office, Exchange, SharePoint, Microsoft Teams, Office 365 Security and Compliance, and Skype for Business, as well as related Client Access Licenses (CAL); Skype, Outlook.com, and OneDrive; LinkedIn that includes Talent, Learning, Sales, and Marketing solutions, as well as premium subscriptions; and Dynamics 365, a set of cloud-based and on-premises business solutions for small and medium businesses, large organizations, and divisions of enterprises. Its Intelligent Cloud segment licenses SQL and Windows Servers, Visual Studio, System Center, and related CALs; GitHub that provides a collaboration platform and code hosting service for developers; and Azure, a cloud platform. It also offers support services and Microsoft consulting services to assist customers in developing, deploying, and managing Microsoft server and desktop solutions; and training and certification to developers and IT professionals on various Microsoft products. Its More Personal Computing segment provides Windows original equipment manufacturer (OEM) licensing and other non-volume licensing of the Windows operating system; Windows Commercial, such as volume licensing of the Windows operating system, Windows cloud services, and other Windows commercial offerings; patent licensing; Windows Internet of Things; and MSN advertising. It also offers Surface, PC accessories, PCs, tablets, gaming and entertainment consoles, and other intelligent devices; Gaming, including Xbox hardware, and Xbox content and services; video games and third-party video game royalties; and Search, including Bing and Microsoft advertising. It sells its products through OEMs, distributors, and resellers; and directly through digital marketplaces, online stores, and retail stores. The company was founded in 1975 and is headquartered in Redmond, Washington.', 'ceo': 'Mr. Satya Nadella', 'sector': 'Technology', 'country': 'US', 'fullTimeEmployees': '163000', 'phone': '14258828080', 'address': '1 Microsoft Way', 'city': 'Redmond', 'state': 'WASHINGTON', 'zip': '98052', 'dcfDiff': -60.78, 'dcf': 216.567, 'image': 'https://financialmodelingprep.com/image-stock/MSFT.png', 'ipoDate': '1986-03-13', 'defaultImage': False, 'isEtf': False, 'isActivelyTrading': True}
balance = [{'date': '2020-06-30', 'symbol': 'MSFT', 'reportedCurrency': 'USD', 'fillingDate': '2020-07-30', 'acceptedDate': '2020-07-30 20:44:46', 'period': 'FY', 'cashAndCashEquivalents': 13576000000, 'shortTermInvestments': 122951000000, 'cashAndShortTermInvestments': 136527000000, 'netReceivables': 32011000000, 'inventory': 1895000000, 'otherCurrentAssets': 11482000000, 'totalCurrentAssets': 181915000000, 'propertyPlantEquipmentNet': 44151000000, 'goodwill': 43351000000, 'intangibleAssets': 7038000000, 'goodwillAndIntangibleAssets': 50389000000, 'longTermInvestments': 0.0, 'taxAssets': 0.0, 'otherNonCurrentAssets': 13138000000, 'totalNonCurrentAssets': 119396000000, 'otherAssets': 11482000000, 'totalAssets': 301311000000, 'accountPayables': 12530000000, 'shortTermDebt': 3749000000, 'taxPayables': 0.0, 'deferredRevenue': 36000000000, 'otherCurrentLiabilities': 10027000000, 'totalCurrentLiabilities': 72310000000, 'longTermDebt': 59578000000, 'deferredRevenueNonCurrent': 3180000000, 'deferredTaxLiabilitiesNonCurrent': 204000000, 'otherNonCurrentLiabilities': 10632000000, 'totalNonCurrentLiabilities': 110697000000, 'otherLiabilities': 10027000000, 'totalLiabilities': 183007000000, 'commonStock': 80552000000, 'retainedEarnings': 34566000000, 'accumulatedOtherComprehensiveIncomeLoss': -43197000000, 'othertotalStockholdersEquity': 0.0, 'totalStockholdersEquity': 118304000000, 'totalLiabilitiesAndStockholdersEquity': 301311000000, 'totalInvestments': 0.0, 'totalDebt': 63327000000, 'netDebt': 49751000000, 'link': 'https://www.sec.gov/Archives/edgar/data/789019/000156459020034944/0001564590-20-034944-index.htm', 'finalLink': 'https://www.sec.gov/Archives/edgar/data/789019/000156459020034944/msft-10k_20200630.htm'}, {'date': '2019-06-30', 'symbol': 'MSFT', 'reportedCurrency': 'USD', 'fillingDate': '2019-08-01', 'acceptedDate': '2019-08-01 16:09:55', 'period': 'FY', 'cashAndCashEquivalents': 11356000000, 'shortTermInvestments': 122463000000, 'cashAndShortTermInvestments': 133819000000, 'netReceivables': 29524000000, 'inventory': 2063000000, 'otherCurrentAssets': 10146000000, 'totalCurrentAssets': 175552000000, 'propertyPlantEquipmentNet': 36477000000, 'goodwill': 42026000000, 'intangibleAssets': 7750000000, 'goodwillAndIntangibleAssets': 49776000000, 'longTermInvestments': 2649000000, 'taxAssets': 0.0, 'otherNonCurrentAssets': 14723000000, 'totalNonCurrentAssets': 111004000000, 'otherAssets': 10146000000, 'totalAssets': 286556000000, 'accountPayables': 9382000000, 'shortTermDebt': 5516000000, 'taxPayables': 0.0, 'deferredRevenue': 32676000000, 'otherCurrentLiabilities': 9351000000, 'totalCurrentLiabilities': 69420000000, 'longTermDebt': 66662000000, 'deferredRevenueNonCurrent': 4530000000, 'deferredTaxLiabilitiesNonCurrent': 233000000, 'otherNonCurrentLiabilities': 7581000000, 'totalNonCurrentLiabilities': 114806000000, 'otherLiabilities': 9351000000, 'totalLiabilities': 184226000000, 'commonStock': 78520000000, 'retainedEarnings': 24150000000, 'accumulatedOtherComprehensiveIncomeLoss': -35330000000, 'othertotalStockholdersEquity': 0.0, 'totalStockholdersEquity': 102330000000, 'totalLiabilitiesAndStockholdersEquity': 286556000000, 'totalInvestments': 0.0, 'totalDebt': 72178000000, 'netDebt': 60822000000, 'link': 'https://www.sec.gov/Archives/edgar/data/789019/000156459019027952/0001564590-19-027952-index.htm', 'finalLink': 'https://www.sec.gov/Archives/edgar/data/789019/000156459019027952/msft-10k_20190630.htm'}, {'date': '2018-06-30', 'symbol': 'MSFT', 'reportedCurrency': 'USD', 'fillingDate': '2018-08-03', 'acceptedDate': '2018-08-03 11:03:33', 'period': 'FY', 'cashAndCashEquivalents': 11946000000, 'shortTermInvestments': 121822000000, 'cashAndShortTermInvestments': 133768000000, 'netReceivables': 26481000000, 'inventory': 2662000000, 'otherCurrentAssets': 6751000000, 'totalCurrentAssets': 169662000000, 'propertyPlantEquipmentNet': 29460000000, 'goodwill': 35683000000, 'intangibleAssets': 8053000000, 'goodwillAndIntangibleAssets': 43736000000, 'longTermInvestments': 1862000000, 'taxAssets': 0.0, 'otherNonCurrentAssets': 7442000000, 'totalNonCurrentAssets': 89186000000, 'otherAssets': 6751000000, 'totalAssets': 258848000000, 'accountPayables': 8617000000, 'shortTermDebt': 3998000000, 'taxPayables': 0.0, 'deferredRevenue': 28905000000, 'otherCurrentLiabilities': 8744000000, 'totalCurrentLiabilities': 58488000000, 'longTermDebt': 72242000000, 'deferredRevenueNonCurrent': 3815000000, 'deferredTaxLiabilitiesNonCurrent': 541000000, 'otherNonCurrentLiabilities': 5211000000, 'totalNonCurrentLiabilities': 117642000000, 'otherLiabilities': 8744000000, 'totalLiabilities': 176130000000, 'commonStock': 71223000000, 'retainedEarnings': 13682000000, 'accumulatedOtherComprehensiveIncomeLoss': -29223000000, 'othertotalStockholdersEquity': 0.0, 'totalStockholdersEquity': 82718000000, 'totalLiabilitiesAndStockholdersEquity': 258848000000, 'totalInvestments': 0.0, 'totalDebt': 76240000000, 'netDebt': 64294000000, 'link': 'https://www.sec.gov/Archives/edgar/data/789019/000156459018019062/0001564590-18-019062-index.htm', 'finalLink': 'https://www.sec.gov/Archives/edgar/data/789019/000156459018019062/msft-10k_20180630.htm'}, {'date': '2017-06-30', 'symbol': 'MSFT', 'reportedCurrency': 'USD', 'fillingDate': '2017-08-02', 'acceptedDate': '2017-08-02 16:15:01', 'period': 'FY', 'cashAndCashEquivalents': 7663000000, 'shortTermInvestments': 125318000000, 'cashAndShortTermInvestments': 132981000000, 'netReceivables': 19792000000, 'inventory': 2181000000, 'otherCurrentAssets': 4897000000, 'totalCurrentAssets': 159851000000, 'propertyPlantEquipmentNet': 23734000000, 'goodwill': 35122000000, 'intangibleAssets': 10106000000, 'goodwillAndIntangibleAssets': 45228000000, 'longTermInvestments': 6023000000, 'taxAssets': 0.0, 'otherNonCurrentAssets': 6250000000, 'totalNonCurrentAssets': 81235000000, 'otherAssets': 4897000000, 'totalAssets': 241086000000, 'accountPayables': 7390000000, 'shortTermDebt': 10121000000, 'taxPayables': 0.0, 'deferredRevenue': 34102000000, 'otherCurrentLiabilities': 6280000000, 'totalCurrentLiabilities': 64527000000, 'longTermDebt': 76073000000, 'deferredRevenueNonCurrent': 10377000000, 'deferredTaxLiabilitiesNonCurrent': 531000000, 'otherNonCurrentLiabilities': 17184000000, 'totalNonCurrentLiabilities': 104165000000, 'otherLiabilities': 6280000000, 'totalLiabilities': 168692000000, 'commonStock': 69315000000, 'retainedEarnings': 2648000000, 'accumulatedOtherComprehensiveIncomeLoss': -24179000000, 'othertotalStockholdersEquity': 0.0, 'totalStockholdersEquity': 72394000000, 'totalLiabilitiesAndStockholdersEquity': 241086000000, 'totalInvestments': 0.0, 'totalDebt': 86194000000, 'netDebt': 78531000000, 'link': 'https://www.sec.gov/Archives/edgar/data/789019/000156459017014900/0001564590-17-014900-index.htm', 'finalLink': 'https://www.sec.gov/Archives/edgar/data/789019/000156459017014900/msft-10k_20170630.htm'}, {'date': '2016-06-30', 'symbol': 'MSFT', 'reportedCurrency': 'USD', 'fillingDate': '2016-07-28', 'acceptedDate': '2016-07-28 16:12:18', 'period': 'FY', 'cashAndCashEquivalents': 6510000000, 'shortTermInvestments': 106730000000, 'cashAndShortTermInvestments': 113240000000, 'netReceivables': 18277000000, 'inventory': 2251000000, 'otherCurrentAssets': 5892000000, 'totalCurrentAssets': 139660000000, 'propertyPlantEquipmentNet': 18356000000, 'goodwill': 17872000000, 'intangibleAssets': 3733000000, 'goodwillAndIntangibleAssets': 21605000000, 'longTermInvestments': 10431000000, 'taxAssets': 0.0, 'otherNonCurrentAssets': 3642000000, 'totalNonCurrentAssets': 54034000000, 'otherAssets': 5892000000, 'totalAssets': 193694000000, 'accountPayables': 6898000000, 'shortTermDebt': 12904000000, 'taxPayables': 0.0, 'deferredRevenue': 27468000000, 'otherCurrentLiabilities': 5949000000, 'totalCurrentLiabilities': 59357000000, 'longTermDebt': 40783000000, 'deferredRevenueNonCurrent': 6441000000, 'deferredTaxLiabilitiesNonCurrent': 1476000000, 'otherNonCurrentLiabilities': 13640000000, 'totalNonCurrentLiabilities': 62340000000, 'otherLiabilities': 5949000000, 'totalLiabilities': 121697000000, 'commonStock': 68178000000, 'retainedEarnings': 2282000000, 'accumulatedOtherComprehensiveIncomeLoss': -19800000000, 'othertotalStockholdersEquity': 0.0, 'totalStockholdersEquity': 71997000000, 'totalLiabilitiesAndStockholdersEquity': 193694000000, 'totalInvestments': 0.0, 'totalDebt': 53687000000, 'netDebt': 47177000000, 'link': 'https://www.sec.gov/Archives/edgar/data/789019/000119312516662209/0001193125-16-662209-index.htm', 'finalLink': 'https://www.sec.gov/Archives/edgar/data/789019/000119312516662209/d187868d10k.htm'}]
cash = [{'date': '2020-06-30', 'symbol': 'MSFT', 'reportedCurrency': 'USD', 'fillingDate': '2020-07-30', 'acceptedDate': '2020-07-30 20:44:46', 'period': 'FY', 'netIncome': 44281000000, 'depreciationAndAmortization': 12796000000, 'deferredIncomeTax': -3620000000, 'stockBasedCompensation': 5289000000, 'changeInWorkingCapital': 3473000000, 'accountsReceivables': -2577000000, 'inventory': 168000000, 'accountsPayables': 3018000000, 'otherWorkingCapital': 109605000000, 'otherNonCashItems': 0.0, 'netCashProvidedByOperatingActivities': 60675000000, 'investmentsInPropertyPlantAndEquipment': -15441000000, 'acquisitionsNet': -2521000000, 'purchasesOfInvestments': -77190000000, 'salesMaturitiesOfInvestments': 84170000000, 'otherInvestingActivites': -1241000000, 'netCashUsedForInvestingActivites': 0.0, 'debtRepayment': -5518000000, 'commonStockIssued': 1343000000, 'commonStockRepurchased': -22968000000, 'dividendsPaid': -15137000000, 'otherFinancingActivites': -3751000000, 'netCashUsedProvidedByFinancingActivities': 0.0, 'effectOfForexChangesOnCash': 0.0, 'netChangeInCash': 2220000000, 'cashAtEndOfPeriod': 13576000000, 'cashAtBeginningOfPeriod': 11356000000, 'operatingCashFlow': 60675000000, 'capitalExpenditure': -15441000000, 'freeCashFlow': 45234000000, 'link': 'https://www.sec.gov/Archives/edgar/data/789019/000156459020034944/0001564590-20-034944-index.htm', 'finalLink': 'https://www.sec.gov/Archives/edgar/data/789019/000156459020034944/msft-10k_20200630.htm'}, {'date': '2019-06-30', 'symbol': 'MSFT', 'reportedCurrency': 'USD', 'fillingDate': '2019-08-01', 'acceptedDate': '2019-08-01 16:09:55', 'period': 'FY', 'netIncome': 39240000000, 'depreciationAndAmortization': 11682000000, 'deferredIncomeTax': -3534000000, 'stockBasedCompensation': 4652000000, 'changeInWorkingCapital': -5042000000, 'accountsReceivables': -2812000000, 'inventory': 597000000, 'accountsPayables': 232000000, 'otherWorkingCapital': 106132000000, 'otherNonCashItems': 0.0, 'netCashProvidedByOperatingActivities': 52185000000, 'investmentsInPropertyPlantAndEquipment': -13925000000, 'acquisitionsNet': -2388000000, 'purchasesOfInvestments': -57697000000, 'salesMaturitiesOfInvestments': 58237000000, 'otherInvestingActivites': 0.0, 'netCashUsedForInvestingActivites': 0.0, 'debtRepayment': -4000000000, 'commonStockIssued': 1142000000, 'commonStockRepurchased': -19543000000, 'dividendsPaid': -13811000000, 'otherFinancingActivites': -675000000, 'netCashUsedProvidedByFinancingActivities': 0.0, 'effectOfForexChangesOnCash': 0.0, 'netChangeInCash': -590000000, 'cashAtEndOfPeriod': 11356000000, 'cashAtBeginningOfPeriod': 11946000000, 'operatingCashFlow': 52185000000, 'capitalExpenditure': -13925000000, 'freeCashFlow': 38260000000, 'link': 'https://www.sec.gov/Archives/edgar/data/789019/000156459019027952/0001564590-19-027952-index.htm', 'finalLink': 'https://www.sec.gov/Archives/edgar/data/789019/000156459019027952/msft-10k_20190630.htm'}, {'date': '2018-06-30', 'symbol': 'MSFT', 'reportedCurrency': 'USD', 'fillingDate': '2018-08-03', 'acceptedDate': '2018-08-03 11:03:33', 'period': 'FY', 'netIncome': 16571000000, 'depreciationAndAmortization': 10261000000, 'deferredIncomeTax': 13040000000, 'stockBasedCompensation': 3940000000, 'changeInWorkingCapital': 15850000000, 'accountsReceivables': -3862000000, 'inventory': -465000000, 'accountsPayables': 1148000000, 'otherWorkingCapital': 111174000000, 'otherNonCashItems': 0.0, 'netCashProvidedByOperatingActivities': 43884000000, 'investmentsInPropertyPlantAndEquipment': -11632000000, 'acquisitionsNet': -888000000, 'purchasesOfInvestments': -137380000000, 'salesMaturitiesOfInvestments': 143937000000, 'otherInvestingActivites': -98000000, 'netCashUsedForInvestingActivites': 0.0, 'debtRepayment': -10060000000, 'commonStockIssued': 1002000000, 'commonStockRepurchased': -10721000000, 'dividendsPaid': -12699000000, 'otherFinancingActivites': -971000000, 'netCashUsedProvidedByFinancingActivities': 0.0, 'effectOfForexChangesOnCash': 0.0, 'netChangeInCash': 4283000000, 'cashAtEndOfPeriod': 11946000000, 'cashAtBeginningOfPeriod': 7663000000, 'operatingCashFlow': 43884000000, 'capitalExpenditure': -11632000000, 'freeCashFlow': 32252000000, 'link': 'https://www.sec.gov/Archives/edgar/data/789019/000156459018019062/0001564590-18-019062-index.htm', 'finalLink': 'https://www.sec.gov/Archives/edgar/data/789019/000156459018019062/msft-10k_20180630.htm'}, {'date': '2017-06-30', 'symbol': 'MSFT', 'reportedCurrency': 'USD', 'fillingDate': '2017-08-02', 'acceptedDate': '2017-08-02 16:15:01', 'period': 'FY', 'netIncome': 21204000000, 'depreciationAndAmortization': 8778000000, 'deferredIncomeTax': -3296000000, 'stockBasedCompensation': 3266000000, 'changeInWorkingCapital': 15021000000, 'accountsReceivables': -925000000, 'inventory': 50000000, 'accountsPayables': 81000000, 'otherWorkingCapital': 95324000000, 'otherNonCashItems': 0.0, 'netCashProvidedByOperatingActivities': 39507000000, 'investmentsInPropertyPlantAndEquipment': -8129000000, 'acquisitionsNet': -25944000000, 'purchasesOfInvestments': -176905000000, 'salesMaturitiesOfInvestments': 164394000000, 'otherInvestingActivites': -197000000, 'netCashUsedForInvestingActivites': 0.0, 'debtRepayment': -7922000000, 'commonStockIssued': 772000000, 'commonStockRepurchased': -11788000000, 'dividendsPaid': -11845000000, 'otherFinancingActivites': -190000000, 'netCashUsedProvidedByFinancingActivities': 0.0, 'effectOfForexChangesOnCash': 0.0, 'netChangeInCash': 1153000000, 'cashAtEndOfPeriod': 7663000000, 'cashAtBeginningOfPeriod': 6510000000, 'operatingCashFlow': 39507000000, 'capitalExpenditure': -8129000000, 'freeCashFlow': 31378000000, 'link': 'https://www.sec.gov/Archives/edgar/data/789019/000156459017014900/0001564590-17-014900-index.htm', 'finalLink': 'https://www.sec.gov/Archives/edgar/data/789019/000156459017014900/msft-10k_20170630.htm'}, {'date': '2016-06-30', 'symbol': 'MSFT', 'reportedCurrency': 'USD', 'fillingDate': '2016-07-28', 'acceptedDate': '2016-07-28 16:12:18', 'period': 'FY', 'netIncome': 16798000000, 'depreciationAndAmortization': 6622000000, 'deferredIncomeTax': 332000000, 'stockBasedCompensation': 2668000000, 'changeInWorkingCapital': 5449000000, 'accountsReceivables': -530000000, 'inventory': 600000000, 'accountsPayables': 88000000, 'otherWorkingCapital': 80303000000, 'otherNonCashItems': 0.0, 'netCashProvidedByOperatingActivities': 33325000000, 'investmentsInPropertyPlantAndEquipment': -8343000000, 'acquisitionsNet': -1393000000, 'purchasesOfInvestments': -129758000000, 'salesMaturitiesOfInvestments': 115341000000, 'otherInvestingActivites': 203000000, 'netCashUsedForInvestingActivites': 0.0, 'debtRepayment': -2796000000, 'commonStockIssued': 668000000, 'commonStockRepurchased': -15969000000, 'dividendsPaid': -11006000000, 'otherFinancingActivites': -369000000, 'netCashUsedProvidedByFinancingActivities': 0.0, 'effectOfForexChangesOnCash': 0.0, 'netChangeInCash': 915000000, 'cashAtEndOfPeriod': 6510000000, 'cashAtBeginningOfPeriod': 5595000000, 'operatingCashFlow': 33325000000, 'capitalExpenditure': -8343000000, 'freeCashFlow': 24982000000, 'link': 'https://www.sec.gov/Archives/edgar/data/789019/000119312516662209/0001193125-16-662209-index.htm', 'finalLink': 'https://www.sec.gov/Archives/edgar/data/789019/000119312516662209/d187868d10k.htm'}]
income = [{'date': '2020-06-30', 'symbol': 'MSFT', 'reportedCurrency': 'USD', 'fillingDate': '2020-07-30', 'acceptedDate': '2020-07-30 20:44:46', 'period': 'FY', 'revenue': 143015000000, 'costOfRevenue': 46078000000, 'grossProfit': 96937000000, 'grossProfitRatio': 0.6778100199279796, 'researchAndDevelopmentExpenses': 19269000000, 'generalAndAdministrativeExpenses': 24709000000, 'sellingAndMarketingExpenses': 19598000000, 'otherExpenses': -40000000, 'operatingExpenses': 43978000000, 'costAndExpenses': 90056000000, 'interestExpense': 2591000000, 'depreciationAndAmortization': 12796000000, 'ebitda': 65715000000, 'ebitdaratio': 0.45949725553263643, 'operatingIncome': 52959000000, 'operatingIncomeRatio': 0.3708422193476209, 'totalOtherIncomeExpensesNet': 2668000000, 'incomeBeforeTax': 53036000000, 'incomeBeforeTaxRatio': 0.3708422193476209, 'incomeTaxExpense': 8755000000, 'netIncome': 44281000000, 'netIncomeRatio': 0.3096248645247002, 'eps': 5.82, 'epsdiluted': 5.76, 'weightedAverageShsOut': 7610000000, 'weightedAverageShsOutDil': 7683000000, 'link': 'https://www.sec.gov/Archives/edgar/data/789019/000156459020034944/0001564590-20-034944-index.htm', 'finalLink': 'https://www.sec.gov/Archives/edgar/data/789019/000156459020034944/msft-10k_20200630.htm'}, {'date': '2019-06-30', 'symbol': 'MSFT', 'reportedCurrency': 'USD', 'fillingDate': '2019-08-01', 'acceptedDate': '2019-08-01 16:09:55', 'period': 'FY', 'revenue': 125843000000, 'costOfRevenue': 42910000000, 'grossProfit': 82933000000, 'grossProfitRatio': 0.6590195720063889, 'researchAndDevelopmentExpenses': 16876000000, 'generalAndAdministrativeExpenses': 23098000000, 'sellingAndMarketingExpenses': 18213000000, 'otherExpenses': -57000000, 'operatingExpenses': 39974000000, 'costAndExpenses': 82884000000, 'interestExpense': 2686000000, 'depreciationAndAmortization': 11682000000, 'ebitda': 54584000000, 'ebitdaratio': 0.43374681150322225, 'operatingIncome': 42959000000, 'operatingIncomeRatio': 0.34716273451840785, 'totalOtherIncomeExpensesNet': 3415000000, 'incomeBeforeTax': 43688000000, 'incomeBeforeTaxRatio': 0.34716273451840785, 'incomeTaxExpense': 4448000000, 'netIncome': 39240000000, 'netIncomeRatio': 0.3118171054409065, 'eps': 5.11, 'epsdiluted': 5.06, 'weightedAverageShsOut': 7673000000, 'weightedAverageShsOutDil': 7753000000, 'link': 'https://www.sec.gov/Archives/edgar/data/789019/000156459019027952/0001564590-19-027952-index.htm', 'finalLink': 'https://www.sec.gov/Archives/edgar/data/789019/000156459019027952/msft-10k_20190630.htm'}, {'date': '2018-06-30', 'symbol': 'MSFT', 'reportedCurrency': 'USD', 'fillingDate': '2018-08-03', 'acceptedDate': '2018-08-03 11:03:33', 'period': 'FY', 'revenue': 110360000000, 'costOfRevenue': 38353000000, 'grossProfit': 72007000000, 'grossProfitRatio': 0.652473722363175, 'researchAndDevelopmentExpenses': 14726000000, 'generalAndAdministrativeExpenses': 22223000000, 'sellingAndMarketingExpenses': 17469000000, 'otherExpenses': -59000000, 'operatingExpenses': 36949000000, 'costAndExpenses': 75302000000, 'interestExpense': 2733000000, 'depreciationAndAmortization': 10261000000, 'ebitda': 45260000000, 'ebitdaratio': 0.4101123595505618, 'operatingIncome': 35058000000, 'operatingIncomeRatio': 0.33050018122508157, 'totalOtherIncomeExpensesNet': 4149000000, 'incomeBeforeTax': 36474000000, 'incomeBeforeTaxRatio': 0.33050018122508157, 'incomeTaxExpense': 19903000000, 'netIncome': 16571000000, 'netIncomeRatio': 0.1501540413193186, 'eps': 2.15, 'epsdiluted': 2.13, 'weightedAverageShsOut': 7700000000, 'weightedAverageShsOutDil': 7794000000, 'link': 'https://www.sec.gov/Archives/edgar/data/789019/000156459018019062/0001564590-18-019062-index.htm', 'finalLink': 'https://www.sec.gov/Archives/edgar/data/789019/000156459018019062/msft-10k_20180630.htm'}, {'date': '2017-06-30', 'symbol': 'MSFT', 'reportedCurrency': 'USD', 'fillingDate': '2017-08-02', 'acceptedDate': '2017-08-02 16:15:01', 'period': 'FY', 'revenue': 89950000000, 'costOfRevenue': 34261000000, 'grossProfit': 55689000000, 'grossProfitRatio': 0.6191106170094497, 'researchAndDevelopmentExpenses': 13037000000, 'generalAndAdministrativeExpenses': 20020000000, 'sellingAndMarketingExpenses': 15539000000, 'otherExpenses': -251000000, 'operatingExpenses': 33057000000, 'costAndExpenses': 67318000000, 'interestExpense': 2222000000, 'depreciationAndAmortization': 8778000000, 'ebitda': 31159000000, 'ebitdaratio': 0.3464035575319622, 'operatingIncome': 22632000000, 'operatingIncomeRatio': 0.25735408560311285, 'totalOtherIncomeExpensesNet': 2739000000, 'incomeBeforeTax': 23149000000, 'incomeBeforeTaxRatio': 0.25735408560311285, 'incomeTaxExpense': 1945000000, 'netIncome': 21204000000, 'netIncomeRatio': 0.23573096164535853, 'eps': 2.74, 'epsdiluted': 2.71, 'weightedAverageShsOut': 7746000000, 'weightedAverageShsOutDil': 7832000000, 'link': 'https://www.sec.gov/Archives/edgar/data/789019/000156459017014900/0001564590-17-014900-index.htm', 'finalLink': 'https://www.sec.gov/Archives/edgar/data/789019/000156459017014900/msft-10k_20170630.htm'}, {'date': '2016-06-30', 'symbol': 'MSFT', 'reportedCurrency': 'USD', 'fillingDate': '2016-07-28', 'acceptedDate': '2016-07-28 16:12:18', 'period': 'FY', 'revenue': 85320000000, 'costOfRevenue': 32780000000, 'grossProfit': 52540000000, 'grossProfitRatio': 0.6157993436474449, 'researchAndDevelopmentExpenses': 11988000000, 'generalAndAdministrativeExpenses': 19260000000, 'sellingAndMarketingExpenses': 14697000000, 'otherExpenses': -195000000, 'operatingExpenses': 31248000000, 'costAndExpenses': 64028000000, 'interestExpense': 1243000000, 'depreciationAndAmortization': 6622000000, 'ebitda': 27719000000, 'ebitdaratio': 0.32488279418659166, 'operatingIncome': 21292000000, 'operatingIncomeRatio': 0.2314932020628223, 'totalOtherIncomeExpensesNet': -298000000, 'incomeBeforeTax': 19751000000, 'incomeBeforeTaxRatio': 0.2314932020628223, 'incomeTaxExpense': 2953000000, 'netIncome': 16798000000, 'netIncomeRatio': 0.19688232536333802, 'eps': 2.12, 'epsdiluted': 2.1, 'weightedAverageShsOut': 7925000000, 'weightedAverageShsOutDil': 8013000000, 'link': 'https://www.sec.gov/Archives/edgar/data/789019/000119312516662209/0001193125-16-662209-index.htm', 'finalLink': 'https://www.sec.gov/Archives/edgar/data/789019/000119312516662209/d187868d10k.htm'}]
balance.reverse()
cash.reverse()
income.reverse()
# from here it's like extracted

#balance = Ed.return_balance_sheet("LMT")
#income = Ed.return_income("LMT")
#cash = Ed.return_cash_flow("LMT")
#quote = Ed.return_stock_quote("LMT")
#profile = Ed.return_stock_profile("MSFT")

print(profile["mktCap"]/profile["price"])
processed_data = Ed.return_processed_data(income, balance, cash, profile)

Gf.save_macd_buy("PDCO")
Gf.save_generic_millions(processed_data["Dates"], processed_data["FreeCashFlow"], processed_data["Symbol"],
                         "Free cash flow", "[mil $]")


#Rp.write_the_report(processed_data)

dates = processed_data["Dates"]
free_cash_flow = processed_data["FreeCashFlow"]
plt.figure(figsize=(15, 3))
#plt.plot(dates, free_cash_flow, dates, net_income, dates, revenue)
#plt.plot(dates, current_equity)
#plt.plot(free_cash_flow)
function = np.polyfit([0, 1, 2, 3, 4], free_cash_flow, 1)
linear_cash = np.polyval(function, [0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
#plt.plot(linear_cash)
print(dates[-1])
extended_dates = [dates[-1] + timedelta(days=x*365) for x in range(1, 6)]
print(extended_dates)
#plt.xticks([0, 1, 2, 3, 4, 5, 6, 7, 8, 9], [x.strftime("%Y") for x in dates+extended_dates])
#plt.legend(["free cash flow", "net income", "revenue", "Current equity"])
#plt.show()

print("*********What I want************")
print(dates)
print("free cash flow", free_cash_flow)
print("net income", processed_data["NetIncome"])
print("revenue", processed_data["Revenue"])
print("current equity", processed_data["CurrentEquity"])
print("shareholder equity", processed_data["ShareholderEquity"])
print("debt", processed_data["Debt"])
print("eps", processed_data["EPS"])
print("dividends", processed_data["Dividends"])
print("roe", processed_data["ROE"])
print("Profit margin", processed_data["ProfitMargin"])
print("Div per share", processed_data["DividendsPerShare"])
plt.plot(processed_data["ProfitMargin"])
#plt.show()